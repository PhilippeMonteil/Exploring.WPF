
# Resources

## [Resources in .NET apps](https://docs.microsoft.com/en-us/dotnet/core/extensions/resources)

## [Retrieve resources in .NET apps](https://docs.microsoft.com/en-us/dotnet/core/extensions/retrieve-resources?source=recommendations)

## [ResourceSet Class](https://docs.microsoft.com/en-us/dotnet/api/system.resources.resourceset?view=net-6.0)

## GetManifestResourceNames

### Example : GetManifestResourceNames, GetManifestResourceStream, ResourceSet

    Assembly assembly = Assembly.GetExecutingAssembly();

    foreach (var resourceName in assembly.GetManifestResourceNames())
    {
        Debug.WriteLine($"resourceName={resourceName}");

        ResourceSet set = new ResourceSet(Application.ResourceAssembly.GetManifestResourceStream(resourceName));

        foreach (DictionaryEntry resource in set)
        {
            Debug.WriteLine("  resource.Key=[{0}] .Value='{1}'", resource.Key, resource.Value);
        }

        Debug.WriteLine("--------------");
    }

#### Debug

    resourceName=TestResources0.g.resources
        resource.Key=[resources/folder0/image0.jpg] .Value='System.IO.UnmanagedMemoryStream'
        resource.Key=[mainwindow.baml] .Value='System.IO.UnmanagedMemoryStream'
    --------------

    resourceName=TestResources0.Properties.Resources.resources
        resource.Key=[String1] .Value='String1:Value1'
    --------------

    resourceName=TestResources0.Resource1.resources
        resource.Key=[String1] .Value='Value1'
        resource.Key=[String2] .Value='Value2'

__Remarque__ : les 'ressources' __Content__ et __Resource__ d'une assembly, TestResources0 ici, apparaissent comme des entrées
dans le __ResourceSet__ TestResources0.g.resources.

### Localisation de ressources .resx

- Créer une ressource __\<resource>.resx__
- Créer des ressources __\<resource>.\<culture>.resx__

Le 'CustomTool' (ResXFileCodeGenerator) associé à \<resource>.resx génère une classe
__TestResources0.Properties.Resources__

    namespace TestResources0.Properties 
    {
        using System;
    
        /// <summary>
        ///   A strongly-typed resource class, for looking up localized strings, etc.
        /// </summary>
        // This class was auto-generated by the StronglyTypedResourceBuilder
        // class via a tool like ResGen or Visual Studio.
        // To add or remove a member, edit your .ResX file then rerun ResGen
        // with the /str option, or rebuild your VS project.
        [global::System.CodeDom.Compiler.GeneratedCodeAttribute("System.Resources.Tools.StronglyTypedResourceBuilder", "17.0.0.0")]
        [global::System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [global::System.Runtime.CompilerServices.CompilerGeneratedAttribute()]
        internal class Resources {

qui expose des propriétés statiques:

    internal static global::System.Globalization.CultureInfo Culture
    internal static string String1 // pour chaque Key

Pour chaque \<Culture> un assembly satellite de même nom, __TestResources0.resources.dll__,
est créé et copié dans un sous-répertoire \<Culture>.

L'assignation de la propriété __CurrentThread.CurrentUICulture__ est prise en compte par 
la classe __Properties.Resources__ et par le __ResourceManager__ :

            ResourceManager rm = new ResourceManager(typeof(Properties.Resources));

            System.Threading.Thread.CurrentThread.CurrentUICulture =
                        new System.Globalization.CultureInfo("es");

            // Properties.Resources.Culture = new System.Globalization.CultureInfo("es");
            Debug.WriteLine($"Properties.Resources.String1={Properties.Resources.String1}");
            Debug.WriteLine($"rm.String1={rm.GetString("String1")}");

## [ResourceManager Class](https://docs.microsoft.com/en-us/dotnet/api/system.resources.resourcemanager?view=net-6.0)

## [ResourceReader Class](https://docs.microsoft.com/en-us/dotnet/api/system.resources.resourcereader?view=net-6.0)

## [WPF Globalization and Localization Overview](https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/wpf-globalization-and-localization-overview?view=netframeworkdesktop-4.8)






## [Binary Resources](https://docs.microsoft.com/en-us/dotnet/desktop/wpf/app-development/wpf-application-resource-content-and-data-files?view=netframeworkdesktop-4.8)

### Application data file types

- Resource Files: Data files that are compiled into either an executable or library WPF assembly.

- Content Files: Standalone data files that have an explicit association with an executable WPF assembly.

- Site of Origin Files: Standalone data files that have no association with an executable WPF assembly.

### Resource Files

    //
    <Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003" ... >  
    ...  
        <ItemGroup>  
            <Resource Include="ResourceFile.xaml" />  
        </ItemGroup>  
  ...  
    </Project>  

    // Navigate to xaml page
    Uri uri = new Uri("/PageResourceFile.xaml", UriKind.Relative);
    StreamResourceInfo info = Application.GetResourceStream(uri);
    System.Windows.Markup.XamlReader reader = new System.Windows.Markup.XamlReader();
    Page page = (Page)reader.LoadAsync(info.Stream);
    this.pageFrame.Content = page;

    //
    Uri pageUri = new Uri("/PageResourceFile.xaml", UriKind.Relative);
    this.pageFrame.Source = pageUri;

    //
    <Frame Name="pageFrame" Source="PageResourceFile.xaml" />

### Example :

    <!--Build Action = Resource-->
    <Image Width="200" Height="100" Margin="4" Stretch="UniformToFill" Source="Resources/Folder0/Image0.jpg"></Image>
    <!--Build Action = Content + Copy to Output = true-->
    <Image Width="200" Height="100" Margin="4" Stretch="UniformToFill" Source="Resources/Folder1/Image0.jpg"></Image>
    <Image Width="200" Height="100" Margin="4" Stretch="UniformToFill" Source="c:/TEMP/Image0.jpg"></Image>
    <Image Width="200" Height="100" Margin="4" Stretch="UniformToFill" Source="pack://application:,,,/ResourceAssembly;Component/Folder0/Image0.jpg"></Image>

    imTest.Source = new BitmapImage(new Uri("pack://application:,,,/ResourceAssembly;Component/Folder0/Image0.jpg"));

## [WPF Resources](https://docs.microsoft.com/en-us/dotnet/desktop/wpf/app-development/wpf-application-resource-content-and-data-files?view=netframeworkdesktop-4.8)

## [Pack URIs in WPF](https://docs.microsoft.com/en-us/dotnet/desktop/wpf/app-development/pack-uris-in-wpf?view=netframeworkdesktop-4.8)

